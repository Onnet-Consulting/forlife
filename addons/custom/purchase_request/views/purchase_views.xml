<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="purchase_order_form_forlife_inherit" model="ir.ui.view">
            <field name="name">purchase.order.form.forlife.inherit</field>
            <field name="model">purchase.order</field>
            <field name="inherit_id" ref="purchase.purchase_order_form"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='partner_ref']" position="attributes">
                    <attribute name="invisible">True</attribute>
                </xpath>
                <xpath expr="//div[hasclass('oe_button_box')]/button[@name='action_view_picking']" position="before">
                    <button name="action_view_stock"
                        string="Invoice"
                        type="object"
                        class="oe_stat_button"
                        icon="fa-truck" attrs="{'invisible': [('count_stock', '=', 0)]}">
                        <div class="o_field_widget o_stat_info">
                            <span class="o_stat_value">
                                <field name="count_stock"/>
                            </span>
                            <span class="o_stat_text">Phiếu xuất khác</span>
                        </div>
                    </button>
                </xpath>
                <xpath expr="//field[@name='purchase_code']" position="replace">
                    <field name="purchase_code" attrs="{'invisible': True}"/>
                    <field name="is_purchase_request" attrs="{'invisible': True}"/>
                    <field name="account_analytic_ids"
                           attrs="{'readonly': ['|',('is_purchase_request', '=', True),('custom_state', 'not in', ('draft', 'confirm'))]}"
                           widget="many2many_tags"/>
                    <field name="production_id"
                           widget="many2many_tags"
                           attrs="{'invisible': [('purchase_type', '=', 'asset')], 'readonly': ['|',('is_purchase_request', '=', True),('custom_state', 'not in', ('draft', 'confirm'))]}"/>
<!--                    <field name="event_id"-->
<!--                           attrs="{'invisible': [('purchase_type', '!=', 'product')], 'readonly': [('custom_state', 'not in', ('draft', 'confirm'))]}"/>-->
                    <field name="occasion_code_ids"
                           attrs="{'readonly': ['|',('is_purchase_request', '=', True), ('custom_state', 'not in', ('draft', 'confirm'))]}"
                           widget="many2many_tags"/>
                    <field name="is_check_line_material_line" invisible="1"/>
                </xpath>
                <xpath expr="//field[@name='has_contract']" position="attributes">
                    <attribute name="invisible">True</attribute>
                </xpath>
                <xpath expr="//field[@name='has_invoice']" position="attributes">
                    <attribute name="invisible">True</attribute>
                </xpath>
                <xpath expr="//field[@name='picking_type_id']" position="attributes">
                    <attribute name="invisible">True</attribute>
                </xpath>
                <xpath expr="//div[@name='date_planned_div']" position="after">
                    <field name="partner_company_id" invisible="1"/>
                    <field name="source_location_id"
                           context="{'company_purchase': True}"
                           attrs="{'invisible': ['|', ('partner_id', '=', False), ('is_inter_company', '=', False)], 'required': [('is_inter_company', '=', True)], 'readonly': [('custom_state', 'not in', ('draft', 'confirm'))]}"
                           domain="[('company_id', '=', partner_company_id), ('usage', '=', 'internal')]"
                           string="Kho nguồn"/>
                    <field name="location_id" string="Kho nhận"
                           attrs="{'readonly': [('custom_state', 'not in', ('draft', 'confirm'))], 'invisible': [('purchase_type', '!=', 'product')], 'required': [('purchase_type', '=', 'product')]}"/>
                    <field name="source_document" string="Tài liệu gốc" attrs="{'readonly': [('custom_state', 'not in', ('draft', 'confirm'))]}"/>
                    <field name="inventory_status"/>
                     <field name="invoice_status_fake" />
                    <field name="invoice_status" invisible="1"/>
                    <!--                    <field name="picking_type_id"/>-->
                    <field name="has_contract" attrs="{'readonly': [('custom_state', 'not in', ('draft', 'confirm'))]}"/>
                    <field name="has_contract_commerce" attrs="{'readonly': [('custom_state', 'not in', ('draft', 'confirm'))]}"/>
                    <field name="note" attrs="{'readonly': [('custom_state', 'not in', ('draft', 'confirm'))]}"/>
                    <field name="rejection_reason" attrs="{'invisible': [('custom_state', '!=', 'reject')]}"
                           string="Lý do từ chối" readonly="1"/>
                </xpath>
                <xpath expr="//div[@name='reminder']" position="attributes">
                    <attribute name="invisible">True</attribute>
                </xpath>
                <xpath expr="//notebook/page[@name='product_cost']" position="after">
                    <page string="Nguyên phụ liệu" name="production_order_domain"
                          attrs="{'invisible': ['|', ('is_check_line_material_line', '=', True), ('is_inter_company', '=', True)]}">
                        <field name="order_line_production_order" class="width-hh" widget="one2many" mode="tree"
                               options="{'no_create': True}">
                            <tree editable="bottom" create="0" delete="0" class="hide_add_and_remove">
                                <control>
                                    <create name="add" string="Add" readonly="1"/>
                                </control>
                                <field name="x_check_npl" force_save="1"/>
                                <field name="product_id" readonly="1" />
                                <field name="name" readonly="1" force_save="1" string="Mô tả"/>
                                <field name="purchase_quantity" readonly="0"/>
                                <field name="product_uom" readonly="1" force_save="1" string="Đơn vị tính"/>
                                <field name="exchange_quantity" readonly="0"/>
                                <field name="product_qty" readonly="1" force_save="1"/>
                                <button name="action_npl" string="NPL" type="object" style="text-align: center;"
                                        class="btn btn-secondary"/>
                            </tree>
                        </field>
                    </page>
                </xpath>
            </field>
        </record>

        <record id="purchase_order_line_material_form_view" model="ir.ui.view">
            <field name="name">purchase.order.line.material.form.view</field>
            <field name="model">purchase.order.line</field>
            <field name="arch" type="xml">
                <form string="">
                    <sheet>
                        <group>
                            <group>
                                <field name="product_id" readonly="1"/>
                                <field name="name" readonly="1"/>
                                <field name="purchase_quantity" readonly="1"/>
                            </group>
                            <group>
                                <field name="purchase_uom" readonly="1"/>
                                <field name="exchange_quantity" readonly="1"/>
                                <field name="product_qty" readonly="1"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Nguyên phụ liệu">
                                <field name="purchase_order_line_material_line_ids" mode="tree" force_save="1">
                                    <tree editable="bottom">
                                        <field name="is_from_po" invisible="1"/>
                                        <field name="type_cost_product" invisible="1"/>
                                        <field name="compute_flag" invisible="1" force_save="1"/>
                                        <field name="product_id" context="{'show_product_code': True}"
                                               attrs="{'readonly': [('is_from_po', '=', True)]}" string="Sản phẩm"/>
                                        <field name="name" string="Mô tả"/>
                                        <field name="uom" attrs="{'readonly': [('is_from_po', '=', True)]}" string="Đơn vị"/>
                                        <field name="product_qty" string="Số lượng" force_save="1"/>
<!--                                        <field name="product_plan_qty" string="Số lượng kế hoạch"/>-->
                                        <field name="price_unit" string="Giá" attrs="{'readonly': [('type_cost_product', '=', False)]}"/>
                                    </tree>
                                </field>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="inherit_purchase_order_material_cost_form_view" model="ir.ui.view">
            <field name="name">purchase.order.form.material.cost</field>
            <field name="model">purchase.order</field>
            <field name="inherit_id" ref="forlife_purchase.inherit_purchase_order_form_view"/>
            <field name="arch" type="xml">

                <xpath expr="//field[@name='purchase_synthetic_ids']//tree//field[@name='after_tax']" position="after">
                    <field name="material_cost" widget="monetary" sum="after_tax" options="{'currency_field': 'company_currency'}"/>
                    <field name="labor_cost" widget="monetary" sum="after_tax" options="{'currency_field': 'company_currency'}"/>
                </xpath>

            </field>
        </record>
    </data>
</odoo>