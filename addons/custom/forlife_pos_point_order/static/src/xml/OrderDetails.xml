<?xml version="1.0" encoding="UTF-8" ?>
<t t-inherit="forlife_pos_layout.CustomOrderSummary" t-inherit-mode="extension">
    <xpath expr="//div[hasclass('custom-line')]" position="inside">
        <div>
            <span>
                <table style="border: 1px solid black;width:100%">
                    <!-- row 1 -->
                    <tr style="border: 1px solid black; text-align:left">
                        <th style="border: 1px solid black; width:25%">Điểm có</th>
                        <th>
                            <t t-if="props.order.partner">
                                <t t-foreach="env.pos.pos_branch" t-as="branch" t-key="branch.id">
                                    <t t-if="branch.name == 'TokyoLife'">
                                        <t t-esc="env.pos.format_currency_no_symbol(props.order.partner.total_points_available_forlife)"/>
                                    </t>
                                    <t t-if="branch.name == 'Format'">
                                        <t t-esc="env.pos.format_currency_no_symbol(props.order.partner.total_points_available_format)"/>
                                    </t>
                                </t>
                            </t>
                        </th>
                        <t t-set="_totalQuantity" t-value="getTotalQuantity()" />
                        <th style="border: 1px solid black;width:25%">Tổng số lượng</th>
                        <th>
                            <t t-esc="_totalQuantity" />
                        </th>
                    </tr>

                    <!-- row 2 -->
                    <tr style="border: 1px solid black; text-align:left">
                        <th style="border: 1px solid black;width:25%">Tiêu điểm</th>
                        <th>
                            <t t-if="env.pos.selectedOrder.total_order_line_point_used">
                                <t t-esc="env.pos.selectedOrder.total_order_line_point_used"/>
                            </t>
                            <t t-else="">
                                0
                            </t>
                        </th>
                        <t t-set="_totalPriceTax" t-value="getTotalPriceWithTax()" />
                        <th style="border: 1px solid black;width:25%">Tổng tiền hàng</th>
                        <th>
                            <t t-esc="env.pos.format_currency(_totalPriceTax)" />
                        </th>
                    </tr>

                    <!-- row 3 -->
                    <t t-set="_totalPriceNotFormat" t-value="getTotalNotFormat()" />
                    <t t-set="_getTotalDiscountCustomDefective" t-value="getTotalDiscountCustomDefective()" />
                    <tr style="border: 1px solid black; text-align:left">
                        <th style="border: 1px solid black;width:25%">Còn lại</th>
                        <th>
                              <t t-esc="env.pos.selectedOrder.total_order_line_redisual"/>
                        </th>
                        <th style="border: 1px solid black;width:25%">Tổng giảm giá</th>
                        <th>
                            <t t-if="_getTotalDiscountCustomDefective > 0">
                                <t t-esc="env.pos.format_currency(_getTotalDiscountCustomDefective)"/>
                            </t>
                            <t t-else="">
                               <t t-esc="env.pos.format_currency(_totalPriceTax - _totalPriceNotFormat)"/>
                            </t>

                        </th>
                    </tr>

                    <!-- row 4 -->
                    <tr style="border: 1px solid black; text-align:left" id="amount_total_row">
                        <th></th>
                        <th></th>
                        <th style="border: 1px solid black;width:25%">Tổng tiền thanh toán</th>
                        <th>
                            <t t-esc="env.pos.format_currency(_totalPriceNotFormat)" />
                        </th>
                    </tr>
                </table>
            </span>
        </div>
    </xpath>
</t>