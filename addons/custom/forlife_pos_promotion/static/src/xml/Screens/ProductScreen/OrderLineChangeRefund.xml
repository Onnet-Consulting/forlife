<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">

    <t t-inherit="forlife_pos_layout.OrderlineChangeRefund" t-inherit-mode="extension" owl="1">
        <xpath expr="//ul[hasclass('custom-info-list')]//li[hasclass('refund-line-unit-price')]" position="replace">
            <t t-set="_totalDiscountSinglemanual" t-value="getTotalDiscountSingleManual()" />
            <li class="refund-line-unit-price" style="width: 13%;">
                <t t-if="props.line.is_applied_promotion()">
                    <t t-esc="env.pos.format_currency(props.line.original_price)"/>
                </t>
                <t t-else="">
                    <t t-if="props.line.display_discount_policy() == 'without_discount' and
                        env.pos.round_decimals_currency(props.line.get_unit_display_price()) &lt; env.pos.round_decimals_currency(props.line.get_taxed_lst_unit_price())">
                        <s>
                            <t t-esc="env.pos.format_currency(props.line.get_taxed_lst_unit_price())" />
                        </s>
                        <t t-if="env.pos.config.iface_tax_included === 'total'">
                            <t t-esc="env.pos.format_currency(props.line.get_unit_display_price() + _totalDiscountSinglemanual)" />
                        </t>
                        <t t-else="">
                            <t t-esc="env.pos.format_currency(props.line.get_unit_display_price())" />
                        </t>
                    </t>
                    <t t-else="">
                        <t t-if="env.pos.config.iface_tax_included === 'total'">
                            <t t-esc="env.pos.format_currency(props.line.get_unit_display_price() + _totalDiscountSinglemanual)" />
                        </t>
                        <t t-else="">
                            <t t-esc="env.pos.format_currency(props.line.get_unit_display_price())" />
                        </t>
                    </t>
                </t>
            </li>
        </xpath>
        <xpath expr="//ul[hasclass('custom-info-list')]" position="inside">
            <t t-if="props.line.is_new_line">
                <t t-if="props.line.get_applied_promotion_str() or []">
                    <t t-foreach="props.line.get_applied_promotion_str()" t-as="promotion" t-key="promotion.id">
                        <li style="width: 60%;">
                            <em>Giảm giá theo CT <t t-esc="promotion.str"/></em>
                        </li>
                        <li style="width: 30%;">
                            <t t-esc="env.pos.format_currency(promotion.discount_amount)"/>
                        </li>
                    </t>
                </t>
                <t t-if="props.line.pricelist_item and !props.line.is_applied_promotion()">
                    <li style="width: 60%; color: cadetblue; font-size: 12px">
                        <em><t t-esc="props.line.pricelist_item.display_name"/></em>
                    </li>
                    <li style="width: 30%; color: cadetblue; font-size: 12px ">
                        <strong t-esc="env.pos.format_currency(props.line.original_price - props.line.pricelist_item.fixed_price)"/>
                    </li>
                </t>
            </t>
        </xpath>
    </t>

</templates>
