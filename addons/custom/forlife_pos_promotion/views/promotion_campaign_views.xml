<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="promotion_campaign_view_form" model="ir.ui.view">
        <field name="name">promotion.campaign.view.form</field>
        <field name="model">promotion.campaign</field>
        <field name="arch" type="xml">
            <form string="Promotion Campaign">
                <header>
                    <field name="state" widget="statusbar" options="{'clickable': '1'}"/>
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button class="oe_stat_button" type="object" name="action_open_programs" icon="fa-tags"
                                context="{'default_campaign_id': active_id}"
                        >
                            <div class="o_form_field o_stat_info">
                                <span class="o_stat_value" readonly="1">
                                    <field name="active_program_count"/>
                                </span>
                                <span class="o_stat_text" >
                                Active Programs</span>
                            </div>
                        </button>
                    </div>
                    <div class="oe_title">
                        <label for="name" string="Program Name"/>
                        <h1>
                            <field name="name" placeholder="Chiến dịch: xuân sang, ngập tràn ưu đãi"/>
                        </h1>
                    </div>
                    <group>
                        <group>
                            <field name="customer_domain" widget="domain"
                                   options="{'model': 'res.partner', 'in_dialog': true}"/>
                            <field name="brand_id"/>
                            <field name="store_ids" widget="many2many_tags"/>
                            <field name="company_id" invisible="1"/>
                        </group>
                        <group>
                            <field name="from_date"/>
                            <field name="to_date"/>
                            <field name="month_ids" widget="many2many_tags"/>
                            <field name="dayofmonth_ids" widget="many2many_tags"/>
                            <field name="dayofweek_ids"  widget="many2many_tags"/>
                            <field name="hour_ids"  widget="many2many_tags"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Combo Programs" name="program_ids" colspan="4">
                            <field name="combo_program_ids"
                                   context="{'active_test':False, 'default_promotion_type': 'combo'}"
                                   mode="tree,kanban" colspan="4" nolabel="1">
                            </field>
                        </page>
                        <page string="Code Programs" name="program_ids" colspan="4">
                            <field name="code_program_ids"
                                   context="{'active_test':False, 'default_promotion_type': 'code'}"
                                   mode="tree,kanban" colspan="4" nolabel="1">
                            </field>
                        </page>
                        <page string="Cart Programs" name="program_ids" colspan="4">
                            <field name="cart_program_ids"
                                   context="{'active_test':False, 'default_promotion_type': 'cart'}"
                                   mode="tree,kanban" colspan="4" nolabel="1">
                            </field>
                        </page>
                        <page string="Chương trình làm giá" name="program_ids" colspan="4">
                            <field name="pricelist_program_ids"
                                   context="{'active_test':False, 'default_promotion_type': 'pricelist'}"
                                   mode="tree,kanban" colspan="4" nolabel="1">
                            </field>
                        </page>
                        <page string="Surprising Reward" name="surprising_reward" colspan="4">
                            <div>Nếu đơn hàng được xét không chứa hoặc không chứa sản phẩm dưới đây, hệ thống sẽ tìm CT KM của các sản phẩm này và tặng mã KM cho Khách hàng</div>
                            <field name="surprising_reward_product_ids"
                                   context="{'active_test':False, 'default_campaign_id': active_id}"
                                   mode="tree" colspan="4" nolabel="1" editable="bottom">
                                <tree>
                                    <field name="to_check_product_ids" widget="many2many_tags"/>
                                    <field name="reward_code_program_id" domain="[('with_code', '=', True)]"/>
                                    <field name="active" widget="boolean_toggle"/>
                                    <field name="has_check_product" widget="boolean_toggle"/>
                                    <field name="max_quantity" attrs="{'invisible': [('has_check_product', '=', True)]}"/>
                                    <field name="issued_qty"/>
                                </tree>
                                <form>
                                    <sheet>
                                        <group>
                                            <field name="to_check_product_ids" widget="many2many_tags"/>
                                            <field name="reward_code_program_id" domain="[('with_code', '=', True)]"/>
                                            <field name="active" widget="boolean_toggle"/>
                                            <field name="has_check_product" widget="boolean_toggle"/>
                                            <field name="max_quantity" attrs="{'invisible': [('has_check_product', '=', True)]}"/>
                                            <field name="issued_qty"/>
                                        </group>
                                    </sheet>
                                </form>
                            </field>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <record id="promotion_campaign_view_tree" model="ir.ui.view">
        <field name="name">promotion.campaign.view.tree</field>
        <field name="model">promotion.campaign</field>
        <field name="arch" type="xml">
            <tree default_order="state desc">
                <field name="sequence" widget="handle"/>
                <field name="name"/>
                <field name="state"/>
                <field name="from_date"/>
                <field name="to_date"/>
                <field name="company_id" groups="base.group_multi_company"/>
            </tree>
        </field>
    </record>

    <record id="promotion_campaign_view_search" model="ir.ui.view">
        <field name="name">promotion.campaign.view.search</field>
        <field name="model">promotion.campaign</field>
        <field name="arch" type="xml">
            <search>
                <field name="name"/>
                <filter string="In Progress" domain="[('state','=','in_progress')]" name="in_progress"/>
                <separator/>
                <group expand="0" string="Group By">
                    <filter string="State" name="state" domain="[]" context="{'group_by':'state'}"/>
                    <filter string="Brand" name="brand" domain="[]" context="{'group_by':'brand_id'}"/>
                </group>
            </search>
        </field>
    </record>

    <record id="promotion_campaign_action" model="ir.actions.act_window">
        <field name="name">Campaign</field>
        <field name="res_model">promotion.campaign</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[]</field>
<!--        <field name="context">{'search_default_in_progress': 1}</field>-->
        <field name="help" type="html">
            <div class="o_loyalty_not_found container">
                <h1>No program found.</h1>
            </div>
        </field>
    </record>

</odoo>
