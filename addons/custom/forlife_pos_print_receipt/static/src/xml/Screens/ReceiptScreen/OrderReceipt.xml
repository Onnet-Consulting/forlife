<?xml version="1.0" encoding="UTF-8" ?>
<templates id="template" xml:spce="preserve">

    <t t-name="OrderReceipt" t-inherit="point_of_sale.OrderReceipt" t-inherit-mode="extension" owl="1">
        <xpath expr="//div[@class='pos-receipt']" position="after">
            <div class="pos-receipt">
                <t t-if="env.pos.pos_brand_info.code == 'FMT'">
                    <t t-call="FormatOrderReceipt"/>
                </t>
                <t t-if="env.pos.pos_brand_info.code == 'TKL'">
                    <t t-call="TokyoLifeOrderReceipt"/>
                </t>
            </div>
        </xpath>
        <xpath expr="//div[@class='pos-receipt']" position="attributes">
            <!-- Hide old template -->
            <attribute name="class">oe_hidden</attribute>
        </xpath>
    </t>

    <t t-name="FormatOrderReceipt" owl="1">
        <img class="pos-receipt-logo"
             src="/forlife_pos_print_receipt/static/src/img/logo-format.png" height="25"/>
        <div>
            <div class="order-header">
                <strong>
                    <t t-esc="receipt.name"/>
                </strong>
                <t t-esc="receipt.date.localestring1"/>
            </div>
        </div>
        <div class="customer-cashier-detail">
            <t t-if="receipt.cashier">
                <div>
                    <span>Nhân viên: </span>
                    <t t-esc="receipt.cashier"/>
                </div>
            </t>
            <t t-if="receipt.partner">
                <div>
                    <span>Khách hàng: </span>
                    <t t-esc="receipt.partner.name"/>
                </div>
                <div>
                    <span>Điện thoại: </span>
                    <t t-esc="receipt.partner.phone || ''"/>
                </div>
                <div>Ghi chú:</div>
            </t>
        </div>
        <t t-call="FormatOrderLinesReceipt"/>
        <t t-call="FormatOrderPaymentLinesReceipt"/>
    </t>

    <t t-name="FormatOrderLinesReceipt" owl="1">
        <div class="orderlines">
            <hr class="separate-line"/>
            <table class="lines-detail">
                <tbody>
                    <tr>
                        <th class="num_1 text">Tên hàng</th>
                        <th class="num_2 number">SL</th>
                        <th class="num_3 number">ĐG</th>
                        <th class="num_4 number">GG</th>
                        <th class="num_5 number">Tổng tiền</th>
                    </tr>
                </tbody>
            </table>
            <hr class="separate-line"/>
            <table class="lines-detail">
                <tbody>
                    <t t-foreach='receipt.orderlines' t-as='line' t-key="line.id">
                        <tr>
                            <td colspan="5">
                                <t t-esc="line.product_name_wrapped[0]"/>
                            </td>
                        </tr>
                        <tr>
                            <td class="num_1 text">
                                <t t-esc="line.product_default_code || ''"/>
                            </td>
                            <td class="num_2 number">
                                <t t-esc="line.quantity"/>
                            </td>
                            <td class="num_3 number">
                                <t t-esc="env.pos.format_currency_no_symbol(line.price)"/>
                            </td>
                            <td class="num_4 number">
                                0
                            </td>
                            <td class="num_5 number">
                                <t t-esc="env.pos.format_currency_no_symbol(line.price_with_tax)"/>
                            </td>
                        </tr>
                    </t>
                </tbody>
            </table>
        </div>
    </t>

    <t t-name="FormatOrderPaymentLinesReceipt" owl="1">
        <hr class="separate-line"/>

        <div class="payment_lines">
            <table class="payment-detail">
                <tbody>
                    <tr class="order-total-x">
                        <td class="title">Tổng cộng:</td>
                        <td class="value">
                            <t t-esc="env.pos.format_currency(receipt.total_rounded)"/>
                        </td>
                    </tr>
                    <tr class="order-total">
                        <td class="title">Chiết khấu</td>
                        <td class="value">
                            <t t-esc="env.pos.format_currency(receipt.total_discount)"/>
                        </td>
                    </tr>
                </tbody>
            </table>

            <hr class="separate-line"/>

            <table class="payment-detail">
                <tbody>
                    <tr class="order-customer-paid">
                        <td>Tổng tiền thanh toán</td>
                        <td class="line value">
                            <t t-esc="env.pos.format_currency(receipt.total_paid || 0)"/>
                        </td>
                    </tr>
                    <t t-foreach='receipt.paymentlines' t-as='line' t-key="line_index">
                        <tr>
                            <td class="line payment_line_detail title">
                                <t t-esc="line.name"/>
                            </td>
                            <td class="line payment_line_detail value">
                                <t t-esc="env.pos.format_currency(line.amount)"/>
                            </td>
                        </tr>
                    </t>
                </tbody>
            </table>
        </div>
    </t>

    <t t-name="TokyoLifeOrderReceipt" owl="1">
        <img class="pos-receipt-logo"
             src="/forlife_pos_print_receipt/static/src/img/logo-tokyolife.png" height="25"/>
    </t>
</templates>